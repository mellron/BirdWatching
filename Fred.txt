using System;
using System.Threading;

public class ConsoleSpinner : IDisposable
{
    private static readonly char[] Sequence = { '|', '/', '-', '\\' }; // The spinner sequence
    private int _counter;
    private bool _active;
    private readonly Thread _thread;

    public ConsoleSpinner()
    {
        _counter = 0;
        _active = false;
        _thread = new Thread(Spin);
    }

    public void Start()
    {
        _active = true;
        if (!_thread.IsAlive)
        {
            _thread.Start(); // Start the spinner in a new thread
        }
    }

    public void Stop()
    {
        _active = false;
        _thread.Join(); // Wait for the thread to finish
    }

    private void Spin()
    {
        while (_active)
        {
            Turn();
            Thread.Sleep(100); // Change the speed of the spinner
        }
    }

    private void Turn()
    {
        Console.Write(Sequence[_counter]); // Write the spinner character
        Console.SetCursorPosition(Console.CursorLeft - 1, Console.CursorTop); // Reset the cursor position

        _counter++;
        if (_counter >= Sequence.Length)
        {
            _counter = 0;
        }
    }

    public void Dispose()
    {
        Stop(); // Stop the spinner when disposing
    }
}
