CONCAT(
    COALESCE(NULLIF(Person.Preferred_FirstNM, ''), Person.FirstNM), ' ',
    CASE
        WHEN COALESCE(NULLIF(Person.Preferred_FirstNM, ''), Person.FirstNM) != COALESCE(NULLIF(Person.Preferred_MiddleNM, ''), Person.MiddleNM)
             AND COALESCE(NULLIF(Person.Preferred_MiddleNM, ''), Person.MiddleNM) IS NOT NULL
             AND COALESCE(NULLIF(Person.Preferred_MiddleNM, ''), Person.MiddleNM) != ''
        THEN CONCAT(COALESCE(NULLIF(Person.Preferred_MiddleNM, ''), Person.MiddleNM), ' ')
        ELSE ''
    END,
    COALESCE(NULLIF(Person.Preferred_LastNM, ''), Person.LastNM)
) AS Name
