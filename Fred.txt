using System;
using System.Threading;

public class Spinner : IDisposable
{
    private readonly string[] _sequence = { "/", "-", "\\", "|" }; // Characters for the spinner
    private int _counter = 0;
    private readonly int _delay;
    private bool _active;
    private readonly Thread _spinnerThread;

    public Spinner(int delay = 100)
    {
        _delay = delay;
        _active = false;
        _spinnerThread = new Thread(Spin);
    }

    public void Start()
    {
        _active = true;
        if (!_spinnerThread.IsAlive)
        {
            _spinnerThread.Start();
        }
    }

    public void Stop()
    {
        _active = false;
        _spinnerThread.Join();  // Wait for the thread to finish
    }

    private void Spin()
    {
        while (_active)
        {
            Console.Write(_sequence[_counter]);   // Write spinner character
            _counter = (_counter + 1) % _sequence.Length;
            Console.Out.Flush();                 // Force the output to update
            Thread.Sleep(_delay);
            Console.SetCursorPosition(Console.CursorLeft - 1, Console.CursorTop); // Go back to overwrite the previous character
        }
    }

    public void Dispose()
    {
        Stop();
    }
}
