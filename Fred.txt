using System;
using Microsoft.SqlServer.Dts.Runtime;
using System.IO;

public void Main()
{
    // Read variables
    string vBloombergFileName = Dts.Variables["User::vBloombergFileName"].Value.ToString();
    string vBSDDevArchiveFolder = Dts.Variables["User::vBSDDevArchiveFolder"].Value.ToString();
    string vBSDArchiveFolder = Dts.Variables["User::vBSDArchiveFolder"].Value.ToString();
    string vFirstSecondRun = Dts.Variables["User::vFirstSecondRun"].Value.ToString();

    // Extract file name and extension separately
    string fileNameWithoutExtension = Path.GetFileNameWithoutExtension(vBloombergFileName);
    string fileExtension = Path.GetExtension(vBloombergFileName);

    // If vFirstSecondRun is not "second", append "1" to the file name; otherwise, append "2"
    if (vFirstSecondRun != "second")
    {
        fileNameWithoutExtension += "1";  // Append "1" to the file name if it's not "second"
    }
    else
    {
        fileNameWithoutExtension += "2";  // Append "2" to the file name if it is "second"
    }

    // Combine the folder path and the modified file name with its extension to create the destination file path
    string vBloombergDestinationFile = Path.Combine(vBSDDevArchiveFolder, fileNameWithoutExtension + fileExtension);

    // Set the destination file path
    Dts.Variables["User::vBloombergDestinationFile"].Value = vBloombergDestinationFile;

    // Now build the source file path based on User::vBSDArchiveFolder and apply the same logic for "1" or "2"
    string vBloombergSourceFile = Path.Combine(vBSDArchiveFolder, fileNameWithoutExtension + fileExtension);

    // Set the source file path
    Dts.Variables["User::vBloombergSourceFile"].Value = vBloombergSourceFile;

    // Signal success
    Dts.TaskResult = (int)ScriptResults.Success;
}
