-- Generating the INSERT statement with a subquery to get the CalculatedRateID
SELECT TOP (10)
    'INSERT INTO [BSDRate].[dbo].[CalculatedRateCategories] ([CalculatedRateID], [CategoryID]) ' +
    'SELECT (SELECT CalculatedRateDefinitions.CalculatedRateID FROM CalculatedRateDefinitions WHERE CalculatedRateDefinitions.ShortName = ''' 
    + TempR.shortname + '''), ' + ISNULL(CAST(CalculatedRateCategories.[CategoryID] AS VARCHAR), '0')
FROM CalculatedRateCategories 
INNER JOIN CalculatedRateDefinitions 
    ON CalculatedRateCategories.CalculatedRateID = CalculatedRateDefinitions.CalculatedRateID
INNER JOIN @tempRateNames TempR 
    ON TempR.shortname = CalculatedRateDefinitions.ShortName;
